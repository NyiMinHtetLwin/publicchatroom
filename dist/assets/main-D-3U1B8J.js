import{c as q,o as L,q as O,a as Y,w as E,T as H,b as $,d as F}from"./main-BVEsgd15.js";import{t as h,n as C,g as T,a as A,e as N,m as v,b as y}from"./en-US-CF28r8Fv.js";/* empty css                */function U(n,t){let e=n,s=t;const r=q(F,"chats");let u=null;return{addChat:async o=>{const g=new Date,c={room:e,username:s,message:o,created_at:H.fromDate(g)};try{return await $(r,c)}catch(i){throw console.log("Error addchat = ",i),i}},getChats:o=>{u&&u(),u=L(O(r,E("room","==",e),Y("created_at")),g=>{g.docChanges().forEach(c=>{c.type==="added"&&o(c.doc.data())})})},updateChatroom:o=>{e=o},updateUsername:o=>{s=o,localStorage.setItem("username",o)}}}function x(n,t){const e=+h(n)-+h(t);return e<0?-1:e>0?1:e}function z(n,t,e){const[s,r]=C(e==null?void 0:e.in,n,t),u=s.getFullYear()-r.getFullYear(),l=s.getMonth()-r.getMonth();return u*12+l}function R(n){return t=>{const s=(n?Math[n]:Math.trunc)(t);return s===0?0:s}}function j(n,t){return+h(n)-+h(t)}function k(n,t){const e=h(n,t==null?void 0:t.in);return e.setHours(23,59,59,999),e}function G(n,t){const e=h(n,t==null?void 0:t.in),s=e.getMonth();return e.setFullYear(e.getFullYear(),s+1,0),e.setHours(23,59,59,999),e}function B(n,t){const e=h(n,t==null?void 0:t.in);return+k(e,t)==+G(e,t)}function J(n,t,e){const[s,r,u]=C(e==null?void 0:e.in,n,n,t),l=x(r,u),a=Math.abs(z(r,u));if(a<1)return 0;r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-l*a);let m=x(r,u)===-l;B(s)&&a===1&&x(s,u)===1&&(m=!1);const d=l*(a-+m);return d===0?0:d}function K(n,t,e){const s=j(n,t)/1e3;return R(e==null?void 0:e.roundingMethod)(s)}function P(n,t,e){const s=A(),r=(e==null?void 0:e.locale)??s.locale??N,u=2520,l=x(n,t);if(isNaN(l))throw new RangeError("Invalid time value");const a=Object.assign({},e,{addSuffix:e==null?void 0:e.addSuffix,comparison:l}),[m,d]=C(e==null?void 0:e.in,...l>0?[t,n]:[n,t]),o=K(d,m),g=(T(d)-T(m))/1e3,c=Math.round((o-g)/60);let i;if(c<2)return e!=null&&e.includeSeconds?o<5?r.formatDistance("lessThanXSeconds",5,a):o<10?r.formatDistance("lessThanXSeconds",10,a):o<20?r.formatDistance("lessThanXSeconds",20,a):o<40?r.formatDistance("halfAMinute",0,a):o<60?r.formatDistance("lessThanXMinutes",1,a):r.formatDistance("xMinutes",1,a):c===0?r.formatDistance("lessThanXMinutes",1,a):r.formatDistance("xMinutes",c,a);if(c<45)return r.formatDistance("xMinutes",c,a);if(c<90)return r.formatDistance("aboutXHours",1,a);if(c<v){const f=Math.round(c/60);return r.formatDistance("aboutXHours",f,a)}else{if(c<u)return r.formatDistance("xDays",1,a);if(c<y){const f=Math.round(c/v);return r.formatDistance("xDays",f,a)}else if(c<y*2)return i=Math.round(c/y),r.formatDistance("aboutXMonths",i,a)}if(i=J(d,m),i<12){const f=Math.round(c/y);return r.formatDistance("xMonths",f,a)}else{const f=i%12,S=Math.trunc(i/12);return f<3?r.formatDistance("aboutXYears",S,a):f<9?r.formatDistance("overXYears",S,a):r.formatDistance("almostXYears",S+1,a)}}function Q(n){return{newli:s=>{const r=P(s.created_at.toDate(),new Date,{addSuffix:!0}),u=`
            <li class="shadow rounded-lg px-4 py-2">
                    <div class="flex justify-between">
                         <h5 class="text-gray-600 font-medium text-sm">${s.username}</h5>
                        <i class="text-gray-300 text-xs">${r}</i>
                    </div>
                <p class="text-gray-600 text-sm">${s.message}</p>
            </li>
        `;n.innerHTML+=u},resetli:()=>{n.innerHTML=""}}}const V=document.querySelector(".chatrooms"),W=document.querySelector(".chat-ul"),w=document.querySelector(".chat-form"),D=document.querySelector(".user-form"),_=document.querySelector(".msg"),I=document.querySelector(".roomtitle"),X=localStorage.username?localStorage.username:"Guest";D.username.placeholder=`username is ${X}`;const M=U("general",X);I.textContent="General";const b=Q(W);w.addEventListener("submit",n=>{n.preventDefault();const t=w.message.value.trim();M.addChat(t).then(()=>w.reset()).catch(e=>console.log(e))});D.addEventListener("submit",n=>{n.preventDefault();const t=D.username.value.trim();M.updateUsername(t),D.reset(),_.innerText=`New name updated to ${t}`,D.username.placeholder=`username is ${t}`,setTimeout(()=>_.innerText="",3e3)});V.addEventListener("click",n=>{n.preventDefault();const t=n.target.closest("button");if(t){b.resetli();const e=t.getAttribute("id"),s=t.querySelector("h3").innerText;I.textContent=s,M.updateChatroom(e),M.getChats(r=>{b.newli(r)})}});M.getChats(n=>{b.newli(n)});
